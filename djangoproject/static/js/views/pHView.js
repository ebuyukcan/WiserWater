// Generated by CoffeeScript 1.4.0

window.WiserWater.pHView = Backbone.View.extend({
  initialize: function(options) {
    this.template = _.template(WiserWater.tpl.get('ph'));
    return this;
  },
  events: {
    "click #submitpH": "onSubmitpH"
  },
  render: function() {
    $(this.el).html(this.template({
      title: "Measuring pH"
    }));
    return this;
  },
  onSubmitpH: function() {
    var cleanliness, phInput, showFeedback, val;
    cleanliness = "very_clean";
    console.debug("in onsubmitph");
    val = $(this.el).find("input#phValue").val();
    phInput = new window.WiserWater.LakePhModel({
      userId: 11,
      lakeId: 1,
      value: val
    });
    console.log('calling save()');
    phInput.save({
      field1: 'test'
    }, {
      wait: true,
      success: function(model, response) {
        var data;
        console.log('response came');
        console.log(response.responseText);
        data = jQuery.parseJSON(response);
        cleanliness = data.result;
        return console.log('success ' + cleanliness);
      },
      error: function() {
        return console.log("error");
      }
    });
    showFeedback = function() {
      $('#loadingContainer').hide();
      console.log('showfeedback' + cleanliness);
      return WiserWater.app.renderFeedback(cleanliness);
    };
    $('#phInstructions').hide();
    $('#loadingContainer').show();
    return setTimeout(showFeedback, 3000);
  }
});
