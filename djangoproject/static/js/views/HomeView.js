// Generated by CoffeeScript 1.4.0

window.WiserWater.HomeView = Backbone.View.extend({
  initialize: function(options) {
    this.template = _.template(WiserWater.tpl.get('home'));
    this.userLakes = new window.WiserWater.UserLakeCollection({
      userId: 11
    });
    this.userNews = new window.WiserWater.UserNewsCollection({
      userId: 11
    });
    return this;
  },
  events: {
    "click .lakeId": "onLakeClick"
  },
  render: function() {
    var self;
    self = this;
    $(this.el).html(this.template());
    this.userLakes.fetch({
      success: function(fetchedLakes) {
        self.userLakes = fetchedLakes;
        return self.renderUserLakes();
      }
    });
    this.userNews.fetch({
      success: function(fetchedNews) {
        self.userNews = fetchedNews;
        return self.renderUserNews();
      }
    });
    return this;
  },
  renderUserLakes: function() {
    _.each(this.userLakes.models, (function(item) {
      var lakeItemView;
      lakeItemView = new window.WiserWater.LakeItemView({
        model: item
      });
      return $("#pinnedLakes").append(lakeItemView.render().el);
    }), this);
    return $("#pinnedLakes").listview('refresh');
  },
  renderUserNews: function() {
    var item, newsItemView;
    item = this.userNews.models[0];
    newsItemView = new window.WiserWater.NewsItemView({
      model: item
    });
    return $("#newsStream").append(newsItemView.render().el);
  },
  onLakeClick: function(args) {
    args.preventDefault();
    return WiserWater.app.renderLake();
  }
});
